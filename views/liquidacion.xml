<openerp>
  <data>

    <!-- check_scanner - Formularios de creacion  -->

    <record id="view_form_check_scanner" model="ir.ui.view">
        <field name="name">Check Scanner Form</field>
        <field name="model">check.scanner</field>
        <field name="arch" type="xml">
            <form string="Escanear">
                <sheet>
                    <group>
                        <field name="name"/>
                        <field name="bank_codigo"/>
                        <field name="bank_suc"/>
                        <field name="bank_cp"/>
                        <field name="bank_nro"/>
                        <field name="bank_cuenta_corriente"/>
                        <field name="bank_imagen_frente"/>
                        <field name="bank_imagen_posterior"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>



    <!-- Liquidacions - Formularios de creacion  -->

    <record id="view_tree_liquidacion" model="ir.ui.view">
        <field name="name">Liquidacion Tree</field>
        <field name="model">liquidacion</field>
        <field name="arch" type="xml">
            <tree string="Liquidaciones">
                <field name="id"/>
                <field name="fecha"/>
                <field name="partner_id"/>
                <field name="active"/>
                <field name="state"/>
            </tree>
        </field>
    </record>


    <act_window
    id="new_payment_action"
    name="Realizar Pago"
    res_model="account.payment"
    src_model="liquidacion"
    view_mode="form"
    multi="False"
    target="new"
    key2="client_action_multi"
    context="{'action': 'realizar_pago', 'partner_id': partner_id, 'payment_type': 'outbound', 'partner_type': 'customer', 'payment_date': fecha}"
     />

    <record id="view_form_liquidacion" model="ir.ui.view">
        <field name="name">Liquidacion Form</field>
        <field name="model">liquidacion</field>
        <field name="arch" type="xml">
            <form string="Liquidacion">
                <header>
                    <button name="confirmar" class="oe_highlight" string="Confirmar" states="cotizacion" type="object" />
                    <button name="facturar" class="oe_highlight" string="Facturar" states="confirmada" type="object" />
                    <button name="ver_factura" class="oe_highlight" string="Ver Factura" states="facturada" type="object" />

                    <!--<button id="new_payment_button" name="%(new_payment_action)d" class="oe_highlight"  string="Pagar" states="confirmada" type="action" /> -->
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet class="oe_form_sheet_width_wider">
                  <xpath expr="." position="inside">
                    <link rel="stylesheet" href="/librasoft-financiera-cheques/static/src/css/liquidacion.css"/>
                  </xpath>
                    <group>
                      <group>
                        <field name="id"/>
                        <field name="fecha" attrs="{'readonly': [('state', '!=', 'cotizacion')]}" context="{'fecha': fecha}"/>
                        <field name="partner_id" attrs="{'readonly': [('state', '!=', 'cotizacion')]}"/>
                        <field name="analytic_id" attrs="{'readonly': [('state', '!=', 'cotizacion')], 'invisible': True}"/>
                        <field name="journal_id" attrs="{'readonly': [('state', '!=', 'cotizacion')], 'required': True}"/>
                        <field name="factura_electronica" attrs="{'readonly': [('state', 'not in', ['cotizacion'])]}"/>
                        <field name="vat_tax_id" attrs="{'readonly': [('state', 'not in', ['cotizacion', 'confirmada'])], 'invisible': [('factura_electronica', '=', False)], 'required': [('factura_electronica', '=', True)]}"/>
                      </group>
                      <group>
                        <field name="receiptbook_id" attrs="{'readonly': [('state', '!=', 'cotizacion')], 'required': True}"/>
                        <field name="payment_method_id" attrs="{'required': True}"/>
                        <field name="currency_id" attrs="{'required': True}"/>
                        <field name="move_id"/>
                        <field name="invoice_id"/>
                      </group>
                    </group>
                    <notebook>
                        <page string="Cheques">
                            <field name="payment_ids" attrs="{'readonly': [('state', '!=', 'cotizacion')]}" context="{'active_model': 'liquidacion', 'action': 'cheque_nuevo', 'fecha': fecha, 'partner_id': partner_id, 'journal_id': journal_id, 'receiptbook_id': receiptbook_id, 'payment_method_id': payment_method_id, 'currency_id': currency_id, 'vat_tax_id': vat_tax_id}">
                                <tree string="Cheques" editable="bottom" >
                                    <field name="partner_type" invisible="1"/>
                                    <field name="currency_id" invisible="1"/>
                                    <field name="payment_date" invisible="1"/>
                                    <field name="payment_type" invisible="1"/>
                                    <field name="payment_method_id" invisible="1"/>
                                    <field name="payment_method_code" invisible="1"/>
                                    <field name="journal_id" invisible="1"/>
                                    <field name="check_type" invisible="1"/>
                                    <field name="state" invisible="1"/>
                                    <!--<field name="check_scanner_id"/>-->
                                    <field name="check_firmante_id" required="1"/>
                                    <field name="check_number" required="1"/>
                                    <field name="check_bank_id" required="1"/>
                                    <field name="amount" sum="Total"/>
                                    <field name="check_issue_date" required="1"/>
                                    <field name="check_payment_date" required="1"/>
                                    <field name="check_fecha_acreditacion" required="1"/>
                                    <field name="check_dias" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                    <field name="check_tasa_fija"/>
                                    <field name="check_monto_fijo" sum="Total" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                    <field name="check_tasa_mensual"/>
                                    <field name="check_monto_mensual" sum="Total" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                    <field name="check_vat_tax_id"/>
                                    <field name="check_monto_iva" sum="Total" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                    <field name="check_monto_neto" sum="Total" attrs="{'readonly': [('state', 'in', ('draft', 'en_cartera', 'depositado', 'enpago', 'rechazado'))]}"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="liquidacion_action" model="ir.actions.act_window">
        <field name="name">Liqudiaciones</field>
        <field name="res_model">liquidacion</field>
        <field name="view_mode">tree,form</field>
        <field name="view_id" ref="view_tree_liquidacion"/>
    </record>


<!--    <act_window name="Pagos"
    res_model="account.payment"
    src_model="liquidacion"
    key2="client_action_multi"
    view_mode="tree,form" target="current"
    view_id="account.view_account_payment_tree"
    id="payment_action"
-->    />


    <!-- Menu Principal del modulo (barra superior) - Financiera -->
    <menuitem id="menu_financiera" name="Financiera - Cheques" />
    
    <!-- SubMenu 1 - Liquidaciones -->
    <menuitem id="smenu_liquidaciones" name="Liquidaciones" parent="menu_financiera"  sequence="0" />
    <menuitem id="smenu_liquidaciones_action" name="Liquidaciones" parent="smenu_liquidaciones" action="liquidacion_action"  sequence="0" />

    <!-- actions opening views on models -->
    <!--
    <record model="ir.actions.act_window" id="librasoft-financiera-cheques.action_window">
      <field name="name">librasoft-financiera-cheques window</field>
      <field name="res_model">librasoft-financiera-cheques.librasoft-financiera-cheques</field>
      <field name="view_mode">tree,form</field>
    </record>
    -->

    <!-- server action to the one above -->
    <!--
    <record model="ir.actions.server" id="librasoft-financiera-cheques.action_server">
      <field name="name">librasoft-financiera-cheques server</field>
      <field name="model_id" ref="model_librasoft-financiera-cheques_librasoft-financiera-cheques"/>
      <field name="code">
        action = {
          "type": "ir.actions.act_window",
          "view_mode": "tree,form",
          "res_model": self._name,
        }
      </field>
    </record>
    -->

    <!-- Top menu item -->
    <!--
    <menuitem name="librasoft-financiera-cheques" id="librasoft-financiera-cheques.menu_root"/>
    -->
    <!-- menu categories -->
    <!--
    <menuitem name="Menu 1" id="librasoft-financiera-cheques.menu_1" parent="librasoft-financiera-cheques.menu_root"/>
    <menuitem name="Menu 2" id="librasoft-financiera-cheques.menu_2" parent="librasoft-financiera-cheques.menu_root"/>
    -->
    <!-- actions -->
    <!--
    <menuitem name="List" id="librasoft-financiera-cheques.menu_1_list" parent="librasoft-financiera-cheques.menu_1"
              action="librasoft-financiera-cheques.action_window"/>
    <menuitem name="Server to list" id="librasoft-financiera-cheques" parent="librasoft-financiera-cheques.menu_2"
              action="librasoft-financiera-cheques.action_server"/>
    -->
  </data>
</openerp>